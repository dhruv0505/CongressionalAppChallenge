<html>
    <header>
        <title></title>
        <link rel="stylesheet" href="style.css">
        <script type="module">
            if ((typeof localStorage.getItem("userID") !== "undefined" && !(typeof localStorage.getItem("userID") === "string" && localStorage.getItem("userID")=="undefined")) && window.location.href.slice(-10)=="login.html"){
                window.location.href = "home.html";
            }

            if ((typeof localStorage.getItem("userID") === "undefined" || (typeof localStorage.getItem("userID") === "string" && localStorage.getItem("userID")=="undefined"))&& window.location.href.slice(-10)!="login.html"){
                window.location.href = "login.html";
            }
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
            import {getAuth, signOut, GoogleAuthProvider} from "https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js";
            import {getDatabase, get, ref, child} from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries

            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
            apiKey: "AIzaSyBnJyc59TYOtolpuh2y9k3JSQdEf8ARg5s",
            authDomain: "the-planet-challenge-4649a.firebaseapp.com",
            projectId: "the-planet-challenge-4649a",
            storageBucket: "the-planet-challenge-4649a.appspot.com",
            messagingSenderId: "110680044656",
            appId: "1:110680044656:web:6cc9f484ba63fad70db0b5",
            measurementId: "G-L5187QDXCJ",
            databaseURL: "https://the-planet-challenge-4649a-default-rtdb.firebaseio.com/"
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const db = getDatabase();
            const dbRef = ref(db);
            get(child(dbRef, `users/${localStorage.getItem("userID")}`)).then((snapshot) => {
                if (snapshot.exists()) {
                    if (snapshot.val().pfp) {
                        document.getElementById("pfpHome").setAttribute("src", `${localStorage.getItem("userID")}.png`);
                    } else {
                        document.getElementById("pfpHome").setAttribute("src", `default.png`);
                    }
                    // try{
                    //     document.getElementById("pfpHome").setAttribute("src", `${localStorage.getItem("userID")}.png`)
                    // }
                    // catch(error) {
                    //     document.getElementById("pfpHome").setAttribute("src", `default.png`);
                    // };
                    document.getElementById("usernameHome").innerHTML = snapshot.val().username;
                    document.getElementById("scoreHome").innerHTML = `Score: ${snapshot.val().score}`;
                    document.getElementById("groupsHome").innerHTML = `Groups: ${snapshot.val().groupNum}`;
                } else {
                    console.log("No data available");
                }
            }).catch((error) => {
                console.error(error);
            });

            function signOut2(){
                const auth = getAuth();
                signOut(auth).then(() => {
                    localStorage.setItem("userID", "undefined")
                    window.location.href="login.html";
                }).catch((error) => {
                // An error happened.
                });
            }
            document.getElementById("logout").addEventListener("click", () => {signOut2()})


            const database = getDatabase(app)
        </script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,0,0" />
    </header>
    <body>
        <!-- NAV BAR -->
        <div class="nav centerContainer">
            <table style="width:1200px;height:75px;">
                <tr>
                    <td>
                        <table>
                            <tr>
                                <td style="width:30px"><a href="home.html" class="navOption centerContainer tooltip"><div class="material-symbols-rounded" style="font-size:30px;">home</div><span>Home</span></a></td>
                                <td style="width:30px;"><a href="allGroups.html" class="navOption centerContainer tooltip"><div class="material-symbols-rounded" style="font-size:30px;">dashboard</div><span>All Groups</span></a></td>
                                <td style="width:30px;"><a href="badges.html" class="navOption centerContainer tooltip"><div class="material-symbols-rounded" style="font-size:30px;">stars</div><span>Badges</span></a></td>
                                <td style="width:30px;"><a href="profilePage.html" class="navOption centerContainer tooltip"><div class="material-symbols-rounded" style="font-size:30px;">person</div><span>Profile</span></a></td>
                            </tr>
                        </table>
                    </td>
                    <td style="padding-top:3px;padding-right:30px;font-size:45px;width:100%;text-align:center;">THE PLANET CHALLENGE - BADGES</td>
                    <td><div style="width:258px;display:flex;justify-content:flex-end;"><a class="navOption centerContainer tooltip2" id="logout"><div class="material-symbols-rounded" style="font-size:30px;">logout</div><span>Log Out</span></a></div></td>
                </tr>
            </table>
        </div>
        <div class="centerContainer" style="margin-top:95px;">
            <div class="homeDashboard">
                <div class="challengeFeature centerContainer">
                    <div>
                        <div class="challengeTitle">5 MINUTE SHOWER OR LESS</div>
                        <br>
                        <div style="width:100%" class="centerContainer">
                            <button onclick="markComplete()" id="taskCompletionButton" class="taskCompletionButton centerContainer">Completed</button>
                        </div>
                    </div>
                </div>
                <button class="accountHolder" onclick="openProfile()"style="border-radius:5px;grid-column:2;grid-row:1;margin-top:5px;background-color:rgb(200,200,200);width:413px;border:none;padding:0px;">
                    <div class="account centerContainer" style="border-bottom-left-radius:5px;border-bottom-right-radius:5px;height:200px;">
                        <table style="margin-bottom: 75px;">
                            <tr><td class="centerContainer"><img id="pfpHome" class="pfp" style="width:120px;height:120px;border-radius:120px;"></td></tr>
                            <tr><td><div id="usernameHome" style="font-family: 'Quicksand', sans-serif;color:rgb(200,200,200);font-size:30px;text-align:center;width:100%"></div></td></tr>
                            <tr class="accountInfo"><td class="centerContainer" id="scoreHome"></td><td class="centerContainer" id="groupsHome"></td></tr>
                        </table>
                    </div>
                </button>
                <div class="recentPosts" style="margin:0px;padding:0px;width:413px;">
                    <br>
                    <iframe src="lastPost.html" style="width:413px;height:198px;border-radius:5px;border:none;margin-left:0px;"></iframe>
                </div>
                <!-- <div class="following">
                    <br>
                    <h1>FOLLOWING:</h1> -->
                    <!-- <table class="followingTable" style="width:100%;margin-top:10px;border-radius:5px;">
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr> 
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                        <tr class="centerContainer">
                            <div class="followingBox">
                                <img src="static.png" class="followingPFP">
                                <span class="followingName">Akshaj Chenreddy</span>
                                <span class="followingDate">October 10, 2022</span>
                                <span class="followingActivity">PICKED UP TRASH</span>
                            </div>
                        </tr>
                    </table> -->
                <!-- </div>  -->
            </div>
        </div>
    </body>
</html> 